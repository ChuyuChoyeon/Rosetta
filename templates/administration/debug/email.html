{% extends "administration/debug/base_debug.html" %}
{% load capture_tags %}
{% load i18n %}

{% block debug_title %}{% trans "邮件测试" %}{% endblock %}

{% block debug_content %}
{% captureas card_content %}
<div class="p-6">
    <h2 class="card-title mb-6 flex items-center gap-2">
        <span class="material-symbols-outlined text-secondary">mail</span>
        {% trans "邮件发送测试" %}
    </h2>
    
    <div role="alert" class="alert border border-info/20 bg-info/5 text-info mb-6">
        <span class="material-symbols-outlined">info</span>
        <div>
            <h3 class="font-bold">{% trans "SMTP 配置信息" %}</h3>
            <div class="text-xs grid grid-cols-2 gap-x-8 gap-y-1 mt-2 opacity-90">
                <span>Host: <span class="font-mono">{{ email_host }}</span></span>
                <span>Port: <span class="font-mono">{{ email_port }}</span></span>
                <span>User: <span class="font-mono">{{ email_host_user }}</span></span>
                <span>Use TLS: <span class="font-mono">{{ email_use_tls }}</span></span>
            </div>
        </div>
    </div>

    <form method="post" class="max-w-md mx-auto w-full space-y-4">
        {% csrf_token %}
        
        <div class="form-control w-full">
            <label class="label">
                <span class="label-text">{% trans "接收邮箱" %}</span>
            </label>
            <input type="email" name="recipient" value="{{ request.user.email }}" class="input input-bordered w-full" required />
            <label class="label">
                <span class="label-text-alt">{% trans "默认发送给当前登录用户" %}</span>
            </label>
        </div>

        <div class="form-control w-full">
            <label class="label">
                <span class="label-text">{% trans "邮件主题" %}</span>
            </label>
            {% trans "Rosetta 邮件发送测试" as default_subject %}
            <input type="text" name="subject" value="{{ default_subject }}" class="input input-bordered w-full" required />
        </div>

        <div class="form-control w-full">
            <label class="label">
                <span class="label-text">{% trans "邮件内容" %}</span>
            </label>
            <textarea name="message" class="textarea textarea-bordered h-24" required>{% trans "这是一条来自 Rosetta 管理后台的测试邮件。如果您收到这封邮件，说明系统的邮件发送功能配置正确。" %}</textarea>
        </div>

        <button type="submit" class="btn btn-primary w-full gap-2">
            <span class="material-symbols-outlined">send</span>
            {% trans "发送测试邮件" %}
        </button>
    </form>
</div>
{% endcaptureas %}
<div class="p-0 overflow-hidden rounded-xl border-none shadow-none hover:shadow-none bg-base-100 border border-base-content/5">
    {{ card_content }}
</div>
{% endblock %}
