<!-- Inspira UI: Neural Background -->
<div class="fixed inset-0 -z-10 bg-base-100" x-data="neuralNetwork()">
    <canvas x-ref="canvas" class="w-full h-full block opacity-50"></canvas>
</div>
<script>
document.addEventListener('alpine:init', () => {
    Alpine.data('neuralNetwork', () => ({
        width: 0,
        height: 0,
        ctx: null,
        particles: [],
        
        init() {
            if (!this.$refs.canvas) return;
            this.ctx = this.$refs.canvas.getContext('2d');
            this.resize();
            window.addEventListener('resize', () => this.resize());
            
            // Create particles
            const particleCount = Math.min(Math.floor(window.innerWidth * window.innerHeight / 15000), 100);
            for(let i = 0; i < particleCount; i++) {
                this.particles.push({
                    x: Math.random() * this.width,
                    y: Math.random() * this.height,
                    vx: (Math.random() - 0.5) * 1.5,
                    vy: (Math.random() - 0.5) * 1.5,
                    size: Math.random() * 2 + 1
                });
            }
            
            this.animate();
        },
        
        resize() {
            if (!this.$refs.canvas) return;
            this.width = window.innerWidth;
            this.height = window.innerHeight;
            this.$refs.canvas.width = this.width;
            this.$refs.canvas.height = this.height;
        },
        
        animate() {
            if (!this.ctx || !this.$refs.canvas) return;
            this.ctx.clearRect(0, 0, this.width, this.height);
            
            // Get primary color from CSS variable or default to indigo
            const pColor = getComputedStyle(document.documentElement).getPropertyValue('--p') || '99 102 241';
            
            // Update and draw particles
            this.particles.forEach((p, i) => {
                p.x += p.vx;
                p.y += p.vy;
                
                if (p.x < 0 || p.x > this.width) p.vx *= -1;
                if (p.y < 0 || p.y > this.height) p.vy *= -1;
                
                this.ctx.beginPath();
                this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                this.ctx.fillStyle = `hsl(${pColor})`;
                this.ctx.fill();
                
                // Draw connections
                for (let j = i + 1; j < this.particles.length; j++) {
                    const p2 = this.particles[j];
                    const dx = p.x - p2.x;
                    const dy = p.y - p2.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    
                    if (dist < 150) {
                        this.ctx.beginPath();
                        this.ctx.strokeStyle = `hsl(${pColor} / ${1 - dist/150})`;
                        this.ctx.lineWidth = 0.5;
                        this.ctx.moveTo(p.x, p.y);
                        this.ctx.lineTo(p2.x, p2.y);
                        this.ctx.stroke();
                    }
                }
            });
            
            requestAnimationFrame(() => this.animate());
        }
    }));
});
</script>
