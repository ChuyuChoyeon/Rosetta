<!-- Inspira UI: Placeholders And Vanish Input -->
{% load i18n %}
<script>
    if (typeof initVanishInput !== 'function') {
        function initVanishInput(action, placeholders) {
            return {
                placeholders: placeholders,
                currentPlaceholder: 0,
                text: '',
                vanish: false,
                get currentText() {
                    return this.placeholders[this.currentPlaceholder];
                },
                init() {
                    setInterval(() => {
                        this.currentPlaceholder = (this.currentPlaceholder + 1) % this.placeholders.length;
                    }, 3000);
                },
                submit() {
                    if (!this.text) {
                        window.location.href = action;
                        return;
                    }
                    this.vanish = true;
                    setTimeout(() => {
                        this.$el.submit();
                    }, 800);
                }
            }
        }
    }
</script>

{% trans "搜索文章..." as p1 %}
{% trans "搜索标签..." as p2 %}
{% trans "输入关键词..." as p3 %}

<form action="{{ action|default:'/search/' }}" method="get" class="relative w-full {{ extra_classes }}"
      x-data="initVanishInput('{{ action|default:"/search/" }}', {% if placeholders %}{{ placeholders|safe }}{% else %}['{{ p1|escapejs }}', '{{ p2|escapejs }}', '{{ p3|escapejs }}']{% endif %})"
      @submit.prevent="submit">
    
    <div class="relative flex items-center overflow-hidden rounded-full bg-base-100 border border-base-content/10 shadow-sm transition-all duration-700 ease-in-out focus-within:shadow-md focus-within:border-primary/50 h-10"
         :class="{ 'scale-95 opacity-0 blur-sm': vanish }">
         
        <div class="w-10 h-full flex items-center justify-center pointer-events-none z-10">
            <span class="text-base-content/40 material-symbols-outlined text-[20px]">search</span>
        </div>
         
        <input type="text" name="q" x-model="text"
               class="flex-1 h-full bg-transparent py-2 pl-0 pr-10 text-sm text-base-content placeholder-transparent focus:outline-none border-none ring-0 appearance-none relative z-20"
               autocomplete="off" />
               
        <!-- Animated Placeholder -->
        <div class="absolute inset-y-0 left-10 right-10 flex items-center pointer-events-none overflow-hidden z-10" x-show="!text">
             <span class="block text-sm text-base-content/40 truncate w-full transition-all duration-500"
                   x-text="currentText"
                   :key="currentPlaceholder"
                   x-transition:enter="transition ease-out duration-500"
                   x-transition:enter-start="opacity-0 translate-y-4"
                   x-transition:enter-end="opacity-100 translate-y-0"
                   x-transition:leave="transition ease-in duration-300"
                   x-transition:leave-start="opacity-100 translate-y-0"
                   x-transition:leave-end="opacity-0 -translate-y-4"></span>
        </div>

        <button type="button" class="absolute right-1 top-0 bottom-0 my-auto btn btn-circle btn-ghost btn-xs text-base-content/60 hover:text-primary hover:bg-transparent z-30 flex items-center justify-center" @click="submit()">
            <span class="material-symbols-outlined text-[20px]">arrow_forward</span>
        </button>
    </div>
</form>
