{% load static core_extras i18n %}
<meta name="description"
      content="{{ meta.description|default:config.SITE_DESCRIPTION|default:'' }}">
<meta name="keywords"
      content="{{ meta.keywords|join:','|default:config.SITE_KEYWORDS|default:'' }}">
<meta name="author"
      content="{{ meta.author|default:config.SITE_AUTHOR|default:'' }}">
<link rel="canonical"
      href="{{ meta.url|default:request.build_absolute_uri }}">
<!-- Hreflang Tags -->
{% get_available_languages as LANGUAGES %}
{% for lang_code, lang_name in LANGUAGES %}
    <link rel="alternate"
          hreflang="{{ lang_code }}"
          href="{{ request.scheme }}://{{ request.get_host }}{% translate_url lang_code %}">
{% endfor %}
<link rel="alternate"
      hreflang="x-default"
      href="{{ request.scheme }}://{{ request.get_host }}{% translate_url 'zh-hans' %}">
<!-- Open Graph / Facebook -->
<meta property="og:type" content="{{ meta.object_type|default:'website' }}">
<meta property="og:url"
      content="{{ meta.url|default:request.build_absolute_uri }}">
<meta property="og:title"
      content="{{ meta.title|default:config.SITE_NAME|default:'' }}">
<meta property="og:description"
      content="{{ meta.description|default:config.SITE_DESCRIPTION|default:'' }}">
<meta property="og:site_name"
      content="{{ config.SITE_NAME|default:'Rosetta' }}">
<meta property="og:locale" content="{{ LANGUAGE_CODE }}">
{% if meta.image %}
    <meta property="og:image" content="{{ meta.image }}">
{% else %}
    <meta property="og:image"
          content="{{ config.SITE_LOGO|default:'/static/theme/img/logo.png' }}">
{% endif %}
<!-- Twitter / X -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:url"
      content="{{ meta.url|default:request.build_absolute_uri }}">
<meta name="twitter:title"
      content="{{ meta.title|default:config.SITE_NAME|default:'' }}">
<meta name="twitter:description"
      content="{{ meta.description|default:config.SITE_DESCRIPTION|default:'' }}">
{% if config.X_USERNAME %}<meta name="twitter:site" content="{{ config.X_USERNAME }}">{% endif %}
{% if meta.image %}
    <meta name="twitter:image" content="{{ meta.image }}">
{% else %}
    <meta name="twitter:image"
          content="{{ config.DEFAULT_PREVIEW_IMAGE|default:config.SITE_LOGO|default:'/static/theme/img/logo.png' }}">
{% endif %}
<!-- JSON-LD Structured Data (Global) -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "{{ config.SITE_NAME|default:'Rosetta'|escapejs }}",
  "url": "{{ request.scheme }}://{{ request.get_host }}/",
  "description": "{{ config.SITE_DESCRIPTION|escapejs }}",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "{{ request.scheme }}://{{ request.get_host }}/search/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
