{% extends "administration/base.html" %}
{% load capture_tags %}

{% block title %}{% if form.instance.pk %}编辑标签: {{ form.instance.name }}{% else %}新建标签{% endif %}{{ config.SITE_ADMIN_SUFFIX|default:" - Rosetta Dashboard" }}{% endblock %}

{% block content %}
<div class="text-sm breadcrumbs mb-4">
    <ul>
        <li><a href="{% url 'administration:index' %}">首页</a></li>
        <li><a href="{% url 'administration:tag_list' %}">标签管理</a></li>
        <li>{% if form.instance.pk %}编辑{% else %}新建{% endif %}</li>
    </ul>
</div>

<div class="max-w-2xl mx-auto">
    {% captureas card_content %}
    <div class="p-6">
        <h2 class="card-title mb-6">
            {% if form.instance.pk %}编辑标签: {{ form.instance.name }}{% else %}新建标签{% endif %}
        </h2>
        
        <form method="post" novalidate>
            {% csrf_token %}
            
            {% if form.non_field_errors %}
            <div class="alert alert-error mb-4">
                <span class="material-symbols-outlined">error</span>
                <div>
                    {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- Name -->
            <div class="form-control w-full mb-4">
                <label class="label">
                    <span class="label-text">名称</span>
                </label>
                <input type="text" name="name" value="{{ form.name.value|default:'' }}" class="input input-bordered w-full {% if form.name.errors %}input-error{% endif %}" required />
                {% if form.name.errors %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ form.name.errors.0 }}</span>
                </label>
                {% endif %}
            </div>

            <!-- Slug -->
            <div class="form-control w-full mb-4">
                <label class="label">
                    <span class="label-text">别名 (Slug)</span>
                </label>
                <input type="text" name="slug" value="{{ form.slug.value|default:'' }}" class="input input-bordered w-full {% if form.slug.errors %}input-error{% endif %}" placeholder="留空自动生成" />
                {% if form.slug.errors %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ form.slug.errors.0 }}</span>
                </label>
                {% endif %}
            </div>

            <!-- Color -->
            <div class="form-control w-full mb-4">
                <label class="label">
                    <span class="label-text">颜色</span>
                </label>
                {% include 'components/color_picker.html' with name='color' value=form.color.value %}
                {% if form.color.errors %}
                <label class="label">
                    <span class="label-text-alt text-error">{{ form.color.errors.0 }}</span>
                </label>
                {% endif %}
            </div>

            <!-- Active -->
            <div class="form-control w-full mb-6">
                <label class="label cursor-pointer justify-start gap-4">
                    <span class="label-text">是否可见</span> 
                    <input type="checkbox" name="is_active" class="checkbox checkbox-primary" {% if form.is_active.value %}checked{% endif %} />
                </label>
                <label class="label">
                    <span class="label-text-alt text-base-content/60">取消勾选后，该标签将在前台隐藏</span>
                </label>
            </div>

            <div class="card-actions justify-end mt-4">
                <a href="{% url 'administration:tag_list' %}" class="btn btn-ghost">取消</a>
                <button type="submit" class="btn btn-primary">保存</button>
            </div>
        </form>
    </div>
    {% endcaptureas %}
    {% include 'components/inspira/card_spotlight.html' with slot_content=card_content extra_classes="p-0 overflow-hidden rounded-2xl border-none shadow-none hover:shadow-none bg-base-100 border border-base-content/5" %}
</div>
{% endblock %}
