{% extends 'base.html' %}

{% block title %}修改密码 - Rosetta{% endblock %}

{% block content %}
    <div class="flex flex-col md:flex-row gap-8">
        <!-- Sidebar -->
        <div class="w-full md:w-1/4">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body items-center text-center">
                    <div class="avatar">
                        <div class="w-24 h-24 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
                            <img src="{{ user.get_avatar_url }}" alt="{{ user.username }}" class="rounded-full object-cover" />
                        </div>
                    </div>
                    <h2 class="card-title mt-4">{{ user.nickname|default:user.username }}</h2>
                    <p class="text-sm text-base-content/60">@{{ user.username }}</p>
                    
                    <div class="divider"></div>
                    
                    <ul class="menu bg-base-100 w-full rounded-box">
                        <li><a href="{% url 'users:profile' %}">个人资料</a></li>
                        <li><a href="{% url 'users:password_change' %}" class="active">修改密码</a></li>
                        <li>
                            <form action="{% url 'users:logout' %}" method="post" class="w-full">
                                {% csrf_token %}
                                <button type="submit" class="w-full text-left text-error">退出登录</button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="w-full md:w-3/4">
            <div class="card bg-base-100 shadow-xl">
                <div class="card-body">
                    <h2 class="card-title mb-6">修改密码</h2>
                    
                    <form method="post" class="space-y-4">
                        {% csrf_token %}
                        
                        {% for field in form %}
                        <div class="form-control w-full">
                            <label class="label">
                                <span class="label-text">{{ field.label }}</span>
                            </label>
                            
                            <input type="{{ field.field.widget.input_type }}" 
                                   name="{{ field.name }}" 
                                   class="input input-bordered w-full focus:input-primary transition-all {% if field.errors %}input-error{% endif %}" 
                                   {% if field.field.required %}required{% endif %}>
                            
                            {% if field.help_text %}
                            <label class="label pt-0">
                                <span class="label-text-alt text-base-content/50">{{ field.help_text|safe }}</span>
                            </label>
                            {% endif %}
                            
                            {% for error in field.errors %}
                            <label class="label pt-0">
                                <span class="label-text-alt text-error">{{ error }}</span>
                            </label>
                            {% endfor %}
                        </div>
                        {% endfor %}

                        <div class="card-actions justify-end mt-6">
                            <button type="submit" class="btn btn-primary">修改密码</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
